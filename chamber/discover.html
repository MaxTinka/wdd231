<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Discover Entebbe - Local Chamber of Commerce" />
  <meta name="author" content="Max Tinka" />
  <meta property="og:title" content="Discover Entebbe | Local Chamber of Commerce" />
  <meta property="og:description" content="Explore the attractions and businesses in Entebbe." />
  <meta property="og:image" content="https://yourdomain.com/images/social-preview.jpg" />
  <meta property="og:url" content="https://yourdomain.com/chamber/discover.html" />
  <title>Discover | Local Chamber of Commerce</title>
  <link rel="icon" href="images/favicon.ico" type="image/x-icon" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" />
  <link rel="stylesheet" href="styles/base.css" />
  <!-- Add discover.css here -->
  <link rel="stylesheet" href="styles/discover.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to Main Content</a>

  <header class="main-header">
    <div class="header-container">
      <div class="logo">
        <svg width="60" height="60" viewBox="0 0 60 60" aria-hidden="true">
          <circle cx="30" cy="30" r="25" fill="#2c3e50" />
          <text x="30" y="38" font-family="Roboto" font-size="20" fill="white" text-anchor="middle">CC</text>
        </svg>
        <span class="name">Local Chamber</span>
      </div>
      <button id="menu-button" aria-expanded="false" aria-label="Navigation menu" aria-controls="primary-nav">
        <span class="hamburger-icon">☰</span>
        <span class="sr-only">Menu</span>
      </button>
    </div>
    <nav id="primary-nav" aria-label="Primary navigation">
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="discover.html" aria-current="page">Discover</a></li>
        <li><a href="directory.html">Directory</a></li>
        <li><a href="join.html">Join</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </nav>
  </header>

  <main id="main-content" class="discover-main">
    <h1>Discover Entebbe</h1>
    <p class="intro">Explore the unique attractions, businesses, and culture in the heart of Entebbe.</p>

    <section class="visit-message" aria-live="polite" tabindex="0">
      <!-- Visit message will be injected here by JavaScript -->
    </section>

    <section class="gallery" aria-label="Local Attractions and Points of Interest">
      <!-- Cards will be dynamically injected here -->
    </section>
  </main>

  <footer>
    <div class="footer-content">
      <div class="contact-info">
        <h3>Contact Us</h3>
        <p>123 Commerce Street</p>
        <p>Entebbe City</p>
        <p>Phone: (256) 770826951</p>
        <p>Email: info@localchamber.org</p>
      </div>
      <div class="social-media">
        <a href="#" aria-label="Facebook">FB</a>
        <a href="#" aria-label="LinkedIn">LI</a>
      </div>
      <div class="development-info">
        <p>&copy; <span id="current-year"></span> Local Chamber of Commerce</p>
        <p>Max Tinka | WDD 231 Project</p>
        <p>Last Modified: <span id="lastModified"></span></p>
      </div>
    </div>
  </footer>

  <script>
    // Auto-fill year and last modified in footer
    document.getElementById("current-year").textContent = new Date().getFullYear();
    document.getElementById("lastModified").textContent = document.lastModified;

    // Mobile menu toggle
    const menuButton = document.getElementById('menu-button');
    const primaryNav = document.getElementById('primary-nav');
    menuButton.addEventListener('click', () => {
      const expanded = menuButton.getAttribute('aria-expanded') === 'true';
      menuButton.setAttribute('aria-expanded', String(!expanded));
      primaryNav.classList.toggle('active');
    });

    // Load JSON data and render cards
    async function loadDiscoverData() {
      try {
        const response = await fetch('data/discover.json');
        if (!response.ok) throw new Error('Network response was not ok');
        const items = await response.json();

        const gallery = document.querySelector('.gallery');
        items.forEach((item, index) => {
          const card = document.createElement('article');
          card.className = 'card';
          card.style.setProperty('--grid-area', `card${index + 1}`);

          card.innerHTML = `
            <h2>${item.name}</h2>
            <figure>
              <img src="${item.image}" alt="${item.alt}" width="300" height="200" loading="lazy" />
              <figcaption>${item.caption || ''}</figcaption>
            </figure>
            <address>${item.address}</address>
            <p>${item.description}</p>
            <button class="learn-more" aria-label="Learn more about ${item.name}">Learn More</button>
          `;

          gallery.appendChild(card);
        });
      } catch (error) {
        console.error('Error loading discover data:', error);
      }
    }

    // LocalStorage visit message logic
    function updateVisitMessage() {
      const visitEl = document.querySelector('.visit-message');
      const lastVisit = localStorage.getItem('lastVisit');
      const now = Date.now();

      if (!lastVisit) {
        visitEl.textContent = "Welcome! Let us know if you have any questions.";
      } else {
        const diffMs = now - parseInt(lastVisit, 10);
        const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));

        if (diffDays < 1) {
          visitEl.textContent = "Back so soon! Awesome!";
        } else if (diffDays === 1) {
          visitEl.textContent = "You last visited 1 day ago.";
        } else {
          visitEl.textContent = `You last visited ${diffDays} days ago.`;
        }
      }
      localStorage.setItem('lastVisit', now.toString());
    }

    // Initialize page
    document.addEventListener('DOMContentLoaded', () => {
      loadDiscoverData();
      updateVisitMessage();
    });
  </script>
</body>
</html>
